<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
        <head>
          <title>PolynomialEvaluationAlgo - aloha-core 3.3.1 API - com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo</title>
          <meta name="description" content="PolynomialEvaluationAlgo - aloha - core 3.3.1 API - com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo" />
          <meta name="keywords" content="PolynomialEvaluationAlgo aloha core 3.3.1 API com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo" />
          <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
          
      <link href="../../../../../lib/template.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../../../../../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css" />
      <script type="text/javascript">
         if(top === self) {
            var url = '../../../../../index.html';
            var hash = 'com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo';
            var anchor = window.location.hash;
            var anchor_opt = '';
            if (anchor.length >= 1)
              anchor_opt = '@' + anchor.substring(1);
            window.location.href = url + '#' + hash + anchor_opt;
         }
   	  </script>
    
        </head>
        <body class="type">
      <div id="definition">
        <img src="../../../../../lib/trait_big.png" />
        <p id="owner"><a href="../../../../package.html" class="extype" name="com">com</a>.<a href="../../../package.html" class="extype" name="com.eharmony">eharmony</a>.<a href="../../package.html" class="extype" name="com.eharmony.aloha">aloha</a>.<a href="../package.html" class="extype" name="com.eharmony.aloha.models">models</a>.<a href="package.html" class="extype" name="com.eharmony.aloha.models.reg">reg</a></p>
        <h1>PolynomialEvaluationAlgo</h1>
      </div>

      <h4 id="signature" class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">trait</span>
      </span>
      <span class="symbol">
        <span class="name">PolynomialEvaluationAlgo</span><span class="result"> extends <a href="../../../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></span>
      </span>
      </h4>
      
          <div id="comment" class="fullcommenttop"><div class="comment cmt"><p>An algorithm for efficiently evaluating polynomials at a given point.  Evaluating first order polynomials is
obviously a sub case, which is important because first order polynomial evaluation is isomorphic to linear
regression, which may be the standard use case.</p><p>As an example, imagine that we wanted to evaluate <i>Z</i>(<i>u</i>,<i>v</i>,<i>x</i>,<i>y</i>) = <i>w<sub>u,v</sub>uv + w<sub>u,v,x</sub>uvx + w<sub>u,v,y</sub>uvy</i>
for coefficients <i>W</i> = [<i>w<sub>u,v</sub></i>, <i>w<sub>u,v,x</sub></i>, <i>w<sub>u,v,y</sub></i>]<sup>T</sup>.</p><p>This is:</p><ul><li><i>Z</i> = <i>w<sub>u,v</sub>uv + w<sub>u,v,x</sub>uvx + w<sub>u,v,y</sub>uvy</i></li><li><i>Z</i> = <i>uv(w<sub>u,v</sub> + w<sub>u,v,x</sub>x + w<sub>u,v,y</sub>y)</i></li></ul><p>That <i>Z</i> can be factored indicates there is a way to structure the algorithm to efficiently reuse
computations.  The way to achieve this is to structure the possible polynomials as a tree and traverse and
aggregate over the tree.  As the tree is traversed, the computation is accumulated.  As a concrete example,
let's take the above example and show it using real code.  Then a motivation of the example will be provided.</p><p>The computation tree works as follows: the edge labels are multiplied by the associated coefficient (0 if non-existent)
to get the node values.  Node values are added together to get the inner product.  So, every time we descend farther
into the tree, we multiply the running product by the value we extract from the input vector X and every time a
weight is found, it is multiplied by the current product and added to the running sum.  The process recurses until
the tree can no longer by traversed.  The sum is then returned.</p><pre><span class="cmt">//           u            u      v                                u     v     x</span>
<span class="cmt">//    (1)*1.00      (1*1.00)*1.000        u     v    w1     (1*1.00*1.000)*0.75        u     v    x      w2</span>
<span class="cmt">//   ----------> 0 ----------------> 1*1.00*1.000 * 0.5 ------------------------> 1*1.00*1.000*0.75 * 0.111</span>
<span class="cmt">//                                                      \</span>
<span class="cmt">//                                                       \        u     v     y</span>
<span class="cmt">//                                                        \ (1*1.00*1.000)*0.25        u     v    y       w3</span>
<span class="cmt">//                                                         ---------------------> 1*1.00*1.000*0.25 * 0.4545</span>
<span class="cmt">//</span>
<span class="cmt">//         u *     v *  w1    +       u *     v *    x *    w2   +       u *     v *    y *     w3</span>
<span class="kw">val</span> Z = <span class="num">1.00</span> * <span class="num">1.000</span> * <span class="num">0.5</span>    +    <span class="num">1.00</span> * <span class="num">1.000</span> * <span class="num">0.75</span> * <span class="num">0.111</span>   +    <span class="num">1.00</span> * <span class="num">1.000</span> * <span class="num">0.25</span> * <span class="num">0.4545</span>

<span class="kw">val</span> X = IndexedSeq(
          <span class="std">Seq</span>((<span class="lit">"a=1"</span>, <span class="num">1.00</span>)),                  <span class="cmt">// u</span>
          <span class="std">Seq</span>((<span class="lit">"b=1"</span>, <span class="num">1.000</span>)),                 <span class="cmt">// v</span>
          <span class="std">Seq</span>((<span class="lit">"c=1"</span>, <span class="num">0.75</span>), (<span class="lit">"c=2"</span>, <span class="num">0.25</span>)))   <span class="cmt">// x and y, respectively</span>

<span class="kw">val</span> W1 =
  PolynomialEvaluator(Coefficient(<span class="num">0</span>, IndexedSeq(<span class="num">0</span>)), <span class="std">Map</span>(
    <span class="lit">"a=1"</span> -&gt; PolynomialEvaluator(Coefficient(<span class="num">0</span>, IndexedSeq(<span class="num">1</span>)), <span class="std">Map</span>(
      <span class="lit">"b=1"</span> -&gt; PolynomialEvaluator(Coefficient(<span class="num">0.5</span>, IndexedSeq(<span class="num">2</span>)), <span class="std">Map</span>(   <span class="cmt">// w1</span>
        <span class="lit">"c=1"</span> -&gt; PolynomialEvaluator(Coefficient(<span class="num">0.111</span>)),                  <span class="cmt">// w2</span>
        <span class="lit">"c=2"</span> -&gt; PolynomialEvaluator(Coefficient(<span class="num">0.4545</span>))))))))            <span class="cmt">// w3</span>


assert(Z == (W1 dot X))</pre><p>While constructing a <a href="PolynomialEvaluator.html" class="extype" name="com.eharmony.aloha.models.reg.PolynomialEvaluator">PolynomialEvaluator</a> via direct means is entirely
possible, it is less straightforward than using a builder to do it.  Below, we show a better way to construct
<a href="PolynomialEvaluator.html" class="extype" name="com.eharmony.aloha.models.reg.PolynomialEvaluator">PolynomialEvaluator</a> instances where we just specify the terms in the
polynomial and the associated coefficient values.  Note linear regression is the special case when all of the
inner maps contain exactly one element.</p><pre><span class="kw">val</span> W2 = (PolynomialEvaluator.builder ++= <span class="std">Map</span>(
  <span class="std">Map</span>(<span class="lit">"a=1"</span> -&gt; <span class="num">0</span>, <span class="lit">"b=1"</span> -&gt; <span class="num">1</span>            ) -&gt; <span class="num">0.5</span>,
  <span class="std">Map</span>(<span class="lit">"a=1"</span> -&gt; <span class="num">0</span>, <span class="lit">"b=1"</span> -&gt; <span class="num">1</span>, <span class="lit">"c=1"</span> -&gt; <span class="num">2</span>) -&gt; <span class="num">0.111</span>,
  <span class="std">Map</span>(<span class="lit">"a=1"</span> -&gt; <span class="num">0</span>, <span class="lit">"b=1"</span> -&gt; <span class="num">1</span>, <span class="lit">"c=2"</span> -&gt; <span class="num">2</span>) -&gt; <span class="num">0.4545</span>
)).result

assert(W2 == W1)</pre><p>Notice the values in the inner map look a little weird.  These are the indices into the input vector x from which
the key comes.  This is for efficiency purposes but allows the algorithm to dramatically prune the search
space while accumulating over the tree.
</p></div><dl class="attributes block"> <dt>Self Type</dt><dd><a href="" class="extype" name="com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo">PolynomialEvaluationAlgo</a> with <a href="MapTreeLike.html" class="extype" name="com.eharmony.aloha.models.reg.MapTreeLike">MapTreeLike</a>[<span class="extype" name="scala.Predef.String">String</span>, <a href="Coefficient.html" class="extype" name="com.eharmony.aloha.models.reg.Coefficient">Coefficient</a>]</dd></dl><div class="toggleContainer block">
          <span class="toggle">Linear Supertypes</span>
          <div class="superTypes hiddenContent"><a href="../../../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a>, <span class="extype" name="scala.Any">Any</span></div>
        </div><div class="toggleContainer block">
          <span class="toggle">Known Subclasses</span>
          <div class="subClasses hiddenContent"><a href="PolynomialEvaluator.html" class="extype" name="com.eharmony.aloha.models.reg.PolynomialEvaluator">PolynomialEvaluator</a></div>
        </div></div>
        

      <div id="mbrsel">
        <div id="textfilter"><span class="pre"></span><span class="input"><input id="mbrsel-input" type="text" accesskey="/" /></span><span class="post"></span></div>
        <div id="order">
              <span class="filtertype">Ordering</span>
              <ol>
                
                <li class="alpha in"><span>Alphabetic</span></li>
                <li class="inherit out"><span>By inheritance</span></li>
              </ol>
            </div>
        <div id="ancestors">
                <span class="filtertype">Inherited<br />
                </span>
                <ol id="linearization">
                  <li class="in" name="com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo"><span>PolynomialEvaluationAlgo</span></li><li class="in" name="scala.AnyRef"><span>AnyRef</span></li><li class="in" name="scala.Any"><span>Any</span></li>
                </ol>
              </div><div id="ancestors">
            <span class="filtertype"></span>
            <ol>
              <li class="hideall out"><span>Hide All</span></li>
              <li class="showall in"><span>Show all</span></li>
            </ol>
            <a href="http://docs.scala-lang.org/overviews/scaladoc/usage.html#members" target="_blank">Learn more about member selection</a>
          </div>
        <div id="visbl">
            <span class="filtertype">Visibility</span>
            <ol><li class="public in"><span>Public</span></li><li class="all out"><span>All</span></li></ol>
          </div>
      </div>

      <div id="template">
        <div id="allMembers">
        

        

        

        <div id="values" class="values members">
              <h3>Value Members</h3>
              <ol><li name="scala.AnyRef#!=" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="!=(x$1:AnyRef):Boolean"></a>
      <a id="!=(AnyRef):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $bang$eq" class="name">!=</span><span class="params">(<span name="arg0">arg0: <a href="../../../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.Any#!=" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="!=(x$1:Any):Boolean"></a>
      <a id="!=(Any):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $bang$eq" class="name">!=</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="scala.AnyRef###" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="##():Int"></a>
      <a id="##():Int"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $hash$hash" class="name">##</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Int">Int</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#==" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="==(x$1:AnyRef):Boolean"></a>
      <a id="==(AnyRef):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $eq$eq" class="name">==</span><span class="params">(<span name="arg0">arg0: <a href="../../../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.Any#==" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="==(x$1:Any):Boolean"></a>
      <a id="==(Any):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $eq$eq" class="name">==</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="scala.Any#asInstanceOf" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="asInstanceOf[T0]:T0"></a>
      <a id="asInstanceOf[T0]:T0"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">asInstanceOf</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="result">: <span class="extype" name="scala.Any.asInstanceOf.T0">T0</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo#at" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="at(x:IndexedSeq[Iterable[(String,Double)]]):Double"></a>
      <a id="at(IndexedSeq[Iterable[(String,Double)]]):Double"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">at</span><span class="params">(<span name="x">x: <a href="../../../../../scala/package.html#IndexedSeq[+A]=IndexedSeq[A]" class="extmbr" name="scala.IndexedSeq">IndexedSeq</a>[<a href="../../../../../scala/package.html#Iterable[+A]=Iterable[A]" class="extmbr" name="scala.Iterable">Iterable</a>[(<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Double">Double</span>)]]</span>)</span><span class="result">: <span class="extype" name="scala.Double">Double</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Evaluate the polynomial represented by this object at the point x.</p><div class="fullcomment"><div class="comment cmt"><p>Evaluate the polynomial represented by this object at the point x.</p></div><dl class="paramcmts block"><dt class="param">x</dt><dd class="cmt"><p>A representation of a point.  The representation is as follows:
         The outer indexed sequence represents groups of features in feature space generated by the same
         feature expander.  The inner sequence is an iterable sequence of key value pairs.  This representation
         is used because it allows efficient encoding of sparse feature spaces.  For instance, we can very
         easily encode multi-part bag of word models as follows.  Let's say the 0th index in the outer sequence
         represents the title of HTML documents and the 1st index represents text inside the body tags in the
         HTML document.</p><pre><span class="kw">case</span> <span class="kw">class</span> Doc(title: <span class="std">String</span>, body: <span class="std">String</span>) {
  <span class="kw">def</span> multiPartBagOfWords = IndexedSeq(tokens(title), tokens(body))
  <span class="kw">private</span>[<span class="kw">this</span>] <span class="kw">def</span> tokens(s: <span class="std">String</span>) = s.trim.toLowerCase.split(<span class="lit">"\\W+"</span>).groupBy(identity).mapValues(_.size.toDouble)
}

<span class="kw">val</span> fox = Doc(<span class="lit">"fox story"</span>, <span class="lit">"The quick brown fox jumps over the lazy dog"</span>)
<span class="kw">val</span> p: PolynomialEvaluationAlgo = ...
p at fox.multiPartBagOfWords</pre></dd><dt>returns</dt><dd class="cmt"><p>this polynomial evaluated at x.
</p></dd></dl></div>
    </li><li name="scala.AnyRef#clone" visbl="prt" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="clone():Object"></a>
      <a id="clone():AnyRef"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">clone</span><span class="params">()</span><span class="result">: <a href="../../../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Attributes</dt><dd>protected[<a href="../../../../../java$lang.html" class="extype" name="java.lang">java.lang</a>] </dd><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.CloneNotSupportedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#eq" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="eq(x$1:AnyRef):Boolean"></a>
      <a id="eq(AnyRef):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">eq</span><span class="params">(<span name="arg0">arg0: <a href="../../../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#equals" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="equals(x$1:Any):Boolean"></a>
      <a id="equals(Any):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">equals</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#finalize" visbl="prt" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="finalize():Unit"></a>
      <a id="finalize():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">finalize</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Attributes</dt><dd>protected[<a href="../../../../../java$lang.html" class="extype" name="java.lang">java.lang</a>] </dd><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="symbol">classOf[java.lang.Throwable]</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#getClass" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="getClass():Class[_]"></a>
      <a id="getClass():Class[_]"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">getClass</span><span class="params">()</span><span class="result">: <span class="extype" name="java.lang.Class">Class</span>[_]</span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo#hBig" visbl="prt" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="hBig(x:IndexedSeq[Iterable[(String,Double)]],s:scala.collection.mutable.Stack[(com.eharmony.aloha.models.reg.MapTreeLike[String,com.eharmony.aloha.models.reg.Coefficient],Double)],sum:Double):Double"></a>
      <a id="hBig(IndexedSeq[Iterable[(String,Double)]],Stack[(MapTreeLike[String,Coefficient],Double)],Double):Double"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">hBig</span><span class="params">(<span name="x">x: <a href="../../../../../scala/package.html#IndexedSeq[+A]=IndexedSeq[A]" class="extmbr" name="scala.IndexedSeq">IndexedSeq</a>[<a href="../../../../../scala/package.html#Iterable[+A]=Iterable[A]" class="extmbr" name="scala.Iterable">Iterable</a>[(<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Double">Double</span>)]]</span>, <span name="s">s: <span class="extype" name="scala.collection.mutable.Stack">Stack</span>[(<a href="MapTreeLike.html" class="extype" name="com.eharmony.aloha.models.reg.MapTreeLike">MapTreeLike</a>[<span class="extype" name="scala.Predef.String">String</span>, <a href="Coefficient.html" class="extype" name="com.eharmony.aloha.models.reg.Coefficient">Coefficient</a>], <span class="extype" name="scala.Double">Double</span>)]</span>, <span name="sum">sum: <span class="extype" name="scala.Double">Double</span></span>)</span><span class="result">: <span class="extype" name="scala.Double">Double</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">A tail-recursive variant of hSmall that won't stack overflow on deep trees.</p><div class="fullcomment"><div class="comment cmt"><p>A tail-recursive variant of hSmall that won't stack overflow on deep trees.  This function is slower in
empirical tests that hSmall.</p></div><dl class="paramcmts block"><dt class="param">x</dt><dd class="cmt"><p>an input vector</p></dd><dt class="param">s</dt><dd class="cmt"><p>a stack of trees and current sums at those trees (replaces call stack in non-tail-recursive hSmall).</p></dd><dt class="param">sum</dt><dd class="cmt"><p>the current sum.</p></dd><dt>returns</dt><dd class="cmt"><p>this polynomial evaluated at x.
</p></dd></dl><dl class="attributes block"> <dt>Attributes</dt><dd>protected[this] </dd></dl></div>
    </li><li name="com.eharmony.aloha.models.reg.PolynomialEvaluationAlgo#hSmall" visbl="prt" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="hSmall(x:IndexedSeq[Iterable[(String,Double)]],xSize:Int,t:com.eharmony.aloha.models.reg.MapTreeLike[String,com.eharmony.aloha.models.reg.Coefficient],prod:Double):Double"></a>
      <a id="hSmall(IndexedSeq[Iterable[(String,Double)]],Int,MapTreeLike[String,Coefficient],Double):Double"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">hSmall</span><span class="params">(<span name="x">x: <a href="../../../../../scala/package.html#IndexedSeq[+A]=IndexedSeq[A]" class="extmbr" name="scala.IndexedSeq">IndexedSeq</a>[<a href="../../../../../scala/package.html#Iterable[+A]=Iterable[A]" class="extmbr" name="scala.Iterable">Iterable</a>[(<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Double">Double</span>)]]</span>, <span name="xSize">xSize: <span class="extype" name="scala.Int">Int</span></span>, <span name="t">t: <a href="MapTreeLike.html" class="extype" name="com.eharmony.aloha.models.reg.MapTreeLike">MapTreeLike</a>[<span class="extype" name="scala.Predef.String">String</span>, <a href="Coefficient.html" class="extype" name="com.eharmony.aloha.models.reg.Coefficient">Coefficient</a>]</span>, <span name="prod">prod: <span class="extype" name="scala.Double">Double</span></span>)</span><span class="result">: <span class="extype" name="scala.Double">Double</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Accumulate, in a depth-first way, the evaluation of the polynomial.</p><div class="fullcomment"><div class="comment cmt"><p>Accumulate, in a depth-first way, the evaluation of the polynomial.</p><p><b>NOTE</b>: This algorithm is recursive (but not tail-recursive) by seems to be about 20% faster than the
following tail-recursive equivalent.  This is probably due to additional object creation in the tail-recursive
method.  Tuple2 instances must be created and the linked list containers probably needs to be created.  In the
non-tail recursive version, we don't do any of this and only perform arithmetic operations (aside from the
iterators and the Options created in the descendant lookup).</p><p>We aren't too afraid of stack overflows because these trees will typically be shallow.  This is because most
use cases don't involve polynomials in thousands of variables (or of degree in the thousands).  That being
said, stack overflows are a real possibility (in test at a depth of ~3000).  To combat this, hBig is provided
but not yet integrated into the at function.</p><pre><span class="kw">import</span> collection.mutable.{Stack <span class="kw">=&gt;</span> MStack}
<span class="kw">def</span> h3(x: IndexedSeq[<span class="std">Seq</span>[(<span class="std">String</span>, <span class="std">Double</span>)]], s: MStack[(MapTreeLike[<span class="std">String</span>, Value], <span class="std">Double</span>)], z: <span class="std">Double</span>): <span class="std">Double</span> = {
  <span class="kw">if</span> (s.isEmpty) z
  <span class="kw">else</span> {
    <span class="kw">val</span> h = s.pop
    <span class="kw">for</span> (i <span class="kw">&lt;-</span> h._1.value.applicableFeatures; p <span class="kw">&lt;-</span> x(i); c <span class="kw">&lt;-</span> h._1.descendants.get(p._1)) s.push((c, p._2 * h._2))
    h3(x, s, z + h._1.value.weight * h._2)
  }
}</pre></div><dl class="paramcmts block"><dt class="param">x</dt><dd class="cmt"><p>an input vector</p></dd><dt class="param">xSize</dt><dd class="cmt"><p>size of input vector (computed once for possible speed improvement).</p></dd><dt class="param">t</dt><dd class="cmt"><p>a tree containing the information necessary to compute the higher order inner product</p></dd><dt class="param">prod</dt><dd class="cmt"><p>product of the items in the path from the root to leaf.</p></dd><dt>returns</dt><dd class="cmt"><p>this polynomial evaluated at x.
</p></dd></dl><dl class="attributes block"> <dt>Attributes</dt><dd>protected[this] </dd></dl></div>
    </li><li name="scala.AnyRef#hashCode" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="hashCode():Int"></a>
      <a id="hashCode():Int"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">hashCode</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Int">Int</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.Any#isInstanceOf" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="isInstanceOf[T0]:Boolean"></a>
      <a id="isInstanceOf[T0]:Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">isInstanceOf</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="scala.AnyRef#ne" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="ne(x$1:AnyRef):Boolean"></a>
      <a id="ne(AnyRef):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">ne</span><span class="params">(<span name="arg0">arg0: <a href="../../../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#notify" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="notify():Unit"></a>
      <a id="notify():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">notify</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#notifyAll" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="notifyAll():Unit"></a>
      <a id="notifyAll():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">notifyAll</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#synchronized" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="synchronized[T0](x$1:=&gt;T0):T0"></a>
      <a id="synchronized[T0](⇒T0):T0"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">synchronized</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="params">(<span name="arg0">arg0: ⇒ <span class="extype" name="java.lang.AnyRef.synchronized.T0">T0</span></span>)</span><span class="result">: <span class="extype" name="java.lang.AnyRef.synchronized.T0">T0</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#toString" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="toString():String"></a>
      <a id="toString():String"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">toString</span><span class="params">()</span><span class="result">: <span class="extype" name="java.lang.String">String</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait():Unit"></a>
      <a id="wait():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait(x$1:Long,x$2:Int):Unit"></a>
      <a id="wait(Long,Int):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Long">Long</span></span>, <span name="arg1">arg1: <span class="extype" name="scala.Int">Int</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait(x$1:Long):Unit"></a>
      <a id="wait(Long):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Long">Long</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li></ol>
            </div>

        

        
        </div>

        <div id="inheritedMembers">
        <div class="parent" name="scala.AnyRef">
              <h3>Inherited from <a href="../../../../../scala/package.html#AnyRef=Object" class="extmbr" name="scala.AnyRef">AnyRef</a></h3>
            </div><div class="parent" name="scala.Any">
              <h3>Inherited from <span class="extype" name="scala.Any">Any</span></h3>
            </div>
        
        </div>

        <div id="groupedMembers">
        <div class="group" name="Ungrouped">
              <h3>Ungrouped</h3>
              
            </div>
        </div>

      </div>

      <div id="tooltip"></div>

      <div id="footer">  </div>
      <script defer="defer" type="text/javascript" id="jquery-js" src="../../../../../lib/jquery.js"></script><script defer="defer" type="text/javascript" id="jquery-ui-js" src="../../../../../lib/jquery-ui.js"></script><script defer="defer" type="text/javascript" id="tools-tooltip-js" src="../../../../../lib/tools.tooltip.js"></script><script defer="defer" type="text/javascript" id="template-js" src="../../../../../lib/template.js"></script>
    </body>
      </html>